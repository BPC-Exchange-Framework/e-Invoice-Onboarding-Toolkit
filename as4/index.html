
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://github.com/BPC-Exchange-Framework/E-Invoice-Onboarding-Toolkit/as4/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.7">
    
    
      
        <title>AS4 Header Validation - E-Invoice Onboarding Toolkit</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.20d9efc8.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Poppins";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/print-site-enum-headings1.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings2.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings3.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings4.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings5.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings6.css">
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
      <link rel="stylesheet" href="../css/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="deep-orange">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#as4-header-validation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="E-Invoice Onboarding Toolkit" class="md-header__button md-logo" aria-label="E-Invoice Onboarding Toolkit" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.89 3 1.96.4L11.11 21l-1.96-.4L12.89 3m6.7 9L16 8.41V5.58L22.42 12 16 18.41v-2.83L19.59 12M1.58 12 8 5.58v2.83L4.41 12 8 15.58v2.83L1.58 12Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            E-Invoice Onboarding Toolkit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              AS4 Header Validation
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="deep-orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="cyan" data-md-color-accent="deep-orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/BPC-Exchange-Framework/E-Invoice-Onboarding-Toolkit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    E-Invoice Onboarding Toolkit
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="E-Invoice Onboarding Toolkit" class="md-nav__button md-logo" aria-label="E-Invoice Onboarding Toolkit" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.89 3 1.96.4L11.11 21l-1.96-.4L12.89 3m6.7 9L16 8.41V5.58L22.42 12 16 18.41v-2.83L19.59 12M1.58 12 8 5.58v2.83L4.41 12 8 15.58v2.83L1.58 12Z"/></svg>

    </a>
    E-Invoice Onboarding Toolkit
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/BPC-Exchange-Framework/E-Invoice-Onboarding-Toolkit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    E-Invoice Onboarding Toolkit
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Project Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        FAQ
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../outcomes/" class="md-nav__link">
        Outcomes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../assumptions/" class="md-nav__link">
        Assumptions
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../tools_and_resources/" class="md-nav__link">
        Tools and Resources
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../python_dev_env/" class="md-nav__link">
        Configure a Python Dev Environment
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../requirements/" class="md-nav__link">
        Package Requirements
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../working_with_the_code/" class="md-nav__link">
        Getting the Code
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_9">
          Using the Code
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Using the Code" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Using the Code
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../using_the_modules/" class="md-nav__link">
        The Modules
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sml_hash_func/" class="md-nav__link">
        SML Hash Functionality
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../dns_query_sml/" class="md-nav__link">
        DNS Query for SML urn
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../smp_rest_query/" class="md-nav__link">
        SMP REST API Query
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          AS4 Header Validation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        AS4 Header Validation
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-pmode-specifications" class="md-nav__link">
    The PMode specifications.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-xsd-files" class="md-nav__link">
    The XSD files.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#obtain-the-schema-using-xmlschema" class="md-nav__link">
    Obtain the schema using xmlschema
  </a>
  
    <nav class="md-nav" aria-label="Obtain the schema using xmlschema">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-1-query-the-xsd" class="md-nav__link">
    Example #1 Query the XSD
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output-1" class="md-nav__link">
    Output #1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-2-output-the-xml-elements" class="md-nav__link">
    Example #2 Output the XML Elements
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output-2" class="md-nav__link">
    Output #2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-3-load-and-validate-xml-against-the-xsd" class="md-nav__link">
    Example #3 Load and validate XML against the XSD
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output-3" class="md-nav__link">
    Output #3
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../test_cases/" class="md-nav__link">
        Test Cases
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../discovery_validation/" class="md-nav__link">
        Discovery Validation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../google_colab_pages/" class="md-nav__link">
        JupyterLab/Notebooks
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_9" type="checkbox" id="__nav_9_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9_9">
          Package/Library API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Package/Library API" data-md-level="2">
        <label class="md-nav__title" for="__nav_9_9">
          <span class="md-nav__icon md-icon"></span>
          Package/Library API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../accessor/" class="md-nav__link">
        accessor.py
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../artifacts/" class="md-nav__link">
        Project Artifacts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../git_workflow/" class="md-nav__link">
        Workflow
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../glossary/" class="md-nav__link">
        Glossary of Terms
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../standards/" class="md-nav__link">
        Standards
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../_license/" class="md-nav__link">
        License
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../print_page/" class="md-nav__link">
        Print the Documentation
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-pmode-specifications" class="md-nav__link">
    The PMode specifications.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-xsd-files" class="md-nav__link">
    The XSD files.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#obtain-the-schema-using-xmlschema" class="md-nav__link">
    Obtain the schema using xmlschema
  </a>
  
    <nav class="md-nav" aria-label="Obtain the schema using xmlschema">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-1-query-the-xsd" class="md-nav__link">
    Example #1 Query the XSD
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output-1" class="md-nav__link">
    Output #1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-2-output-the-xml-elements" class="md-nav__link">
    Example #2 Output the XML Elements
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output-2" class="md-nav__link">
    Output #2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-3-load-and-validate-xml-against-the-xsd" class="md-nav__link">
    Example #3 Load and validate XML against the XSD
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output-3" class="md-nav__link">
    Output #3
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/BPC-Exchange-Framework/E-Invoice-Onboarding-Toolkit/edit/master/docs/as4.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


<h1 id="as4-header-validation">AS4 Header Validation</h1>
<p>The OST Delivery component is concerned with validating the SOAP message header of the email used to exchange the invoice payload. The AS4 SOAP header of the email wrapper or "envelope" for the e-invoice must be conformant to ebXML messaging standards.  The initial implementation specification can be found at: <a href="docs.oasis-open.org/ebxml-msg/ebms/v3.0/core/os/ebms_core-3.0-spec-os.html">XML Namespace for AS4 Profile of ebMS 3.0 Version 1.0</a>.</p>
<p>In November, 2021 the EBXML workgroup promulgated a conformance profile to supplement the original ebms specification with additional P-mode parameters not originally included in the specification.  The new profile did not provide a namespace nor specific technical specification in the form of an .XSD file or examples to validate the additional parameters.  </p>
<p>Absent such a reference, review of additional resources identified a <a href="https://ec.europa.eu/digital-building-blocks/code/projects/EDELIVERY/repos/eessi-as4.net/browse/output/doc/schemas/send-pmode-schema.xsd">sample XSD hosted by ec.europa.eu</a> (The European Commission).  This XSD meets many of the requirements as specified by the ebXML workgroup and is consistent with the newly formulated rules and yet provides concrete guidance as a specification implemented by PEPPOL.<br />
</br></p>
<details class="warn" open="open">
<summary>Use of EU Schema for Validation</summary>
<p>The EU schema used as an exmaple should be considered non-normative for the new EBXML workgroup specification, and further, <strong>non-conformant</strong> as some of the specified P-modes are not directly addressed by the EU schema definition.   </p>
<p>Where there is variance between EU standards and those of the ebXML workgroup, the methods provided to validate an XML header is valid when used against and well formed XSD.</p>
</details>
<h2 id="the-pmode-specifications">The PMode specifications.</h2>
<p>The approved November, 2021 ebXML workgroup conformance profile provided for the following PMode configurations.  </p>
<p><strong>NOTE:</strong> All sample xml is from the EU send-pmode-schema.xsd.</p>
<p></br></p>
<p><strong>PMode.Agreement</strong><br />
<em>Allowed Value: http://bpcpilot.change.me/tempagreement.html.</em>  </p>
<pre><code>&lt;xs:complexType name="AgreementReference"&gt;
    &lt;xs:sequence&gt;
        &lt;xs:element minOccurs="0" maxOccurs="1" name="Value" type="xs:string" /&gt;
        &lt;xs:element minOccurs="0" maxOccurs="1" name="Type" type="xs:string" /&gt;
        &lt;xs:element minOccurs="0" maxOccurs="1" name="PModeId" type="xs:string" /&gt;
    &lt;/xs:sequence&gt;
</code></pre>
<p></br>
</br></p>
<p>These P-Modes were already included as part of the previous ebms/AS4 spec:<br />
 <br/></p>
<p><strong>PMode[1].ReceptionAwareness.Retry</strong>  <br />
<em>Allowed Value: True</em>  </p>
<pre><code> &lt;xs:complexType name="ReceptionAwareness"&gt;
    &lt;xs:sequence&gt;
        &lt;xs:element minOccurs="1" maxOccurs="1" name="IsEnabled" type="xs:boolean" /&gt;
        &lt;xs:element minOccurs="0" maxOccurs="1" default="5" name="RetryCount" type="xs:int" /&gt;  
        &lt;xs:element minOccurs="0" maxOccurs="1" default="00:01:00" name="RetryInterval" type="xs:string"/&gt;
    &lt;/xs:sequence&gt;|
</code></pre>
<p></br>
</br></p>
<p><strong>PMode[1].Security.X509.Encryption.Encryp</strong><br />
<em>Allowed Value: True</em>  </p>
<pre><code>&lt;xs:complexType name="Security"&gt;
    &lt;xs:sequence&gt;
        &lt;xs:element minOccurs="0" maxOccurs="1" name="Signing" type="tns:Signing" /&gt;
        &lt;xs:element minOccurs="0" maxOccurs="1" name="Encryption" type="tns:Encryption" /&gt;
    &lt;/xs:sequence&gt;
</code></pre>
<p></br>
</br></p>
<p><strong>PMode[1].Security.X509.Encryption.Algorithm</strong><br />
<em>Allowed value: <em>http://www.w3.org/2009/xmlenc11#aes256-gcm</em></em>  </p>
<pre><code>&lt;xs:complexType name="Signing"&gt;&lt;xs:sequence&gt;
&lt;xs:element minOccurs="1" maxOccurs="1" name="IsEnabled" type="xs:boolean" /&gt;
    &lt;xs:choice minOccurs="1" maxOccurs="1"&gt;
        &lt;xs:element minOccurs="0" maxOccurs="1" name="CertificateFindCriteria" type="tns:CertificateFindCriteria" /&gt;
        &lt;xs:element minOccurs="0" maxOccurs="1" name="PrivateKeyCertificate" type="tns:PrivateKeyCertificate" /&gt;
    &lt;/xs:choice&gt; 
    &lt;xs:element minOccurs="0" maxOccurs="1" default="BSTReference" name="KeyReferenceMethod" type="tns:X509ReferenceType" /&gt;\
    &lt;xs:element minOccurs="0" maxOccurs="1" default="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256" name="Algorithm" type="xs:string" /&gt;
    &lt;xs:element minOccurs="0" maxOccurs="1" default="http://www.w3.org/2001/04/xmlenc#sha256" name="HashFunction" type="xs:string" /&gt;
&lt;/xs:sequence&gt;
</code></pre>
<p></br>
</br></p>
<p>These P-Mode values are "net new" as of the November, 2021 ebXML workgroup specification change. </p>
<p></br>
</br></p>
<p><strong>PMode[1].ReceptionAwareness.Retry.Parameters</strong><br />
<em>Allowed Value: Unknown.  The text of the specification reads: "Access points must retry at least five times over six hours with no fewer than 15 seconds between attempts, and shall not continue retrying for longer than twelve hours, at which point they should throw a missing receipt error as specified in the AS4 Profile of ebMS 3.0 Version 1.0 specification."  The data type specified in the requirement is "Constant."</em>  </p>
<pre><code>&lt;xs:complexType name="ReceptionAwareness"&gt;
    &lt;xs:sequence&gt;
        &lt;xs:element minOccurs="1" maxOccurs="1" name="IsEnabled" type="xs:boolean" /&gt;
        &lt;xs:element minOccurs="0" maxOccurs="1" default="5" name="RetryCount" type="xs:int" /&gt;
        &lt;xs:element minOccurs="0" maxOccurs="1" default="00:01:00" name="RetryInterval" type="xs:string" /&gt;
    &lt;/xs:sequence&gt;|
</code></pre>
<p></br>
</br></p>
<p><strong>PMode[1].ReceptionAwareness.DetectDuplicates.Parameters</strong><br />
<em>Allowed Value: Unknown.   The text of the spec reads: "A receiving Access Point MUST detect if a received message is a duplicate of a message already received within 30 days."    The data type specified in the requirement is "Constant."</em>  </p>
<pre><code>NA
</code></pre>
<p></br>
</br></p>
<p><strong>PMode[1].ErrorHandling.Report.MissingReceiptNotifyProducer</strong>
<em>Allowed Value: True</em></p>
<pre><code>&lt;xs:complexType name="SendHandling"&gt;
    &lt;xs:sequence&gt;
        &lt;xs:element minOccurs="1" maxOccurs="1" name="NotifyMessageProducer" type="xs:boolean" /&gt;
        &lt;xs:element minOccurs="0" maxOccurs="1" name="NotifyMethod" type="tns:Method" /&gt;
    &lt;/xs:sequence&gt;|
</code></pre>
<p></br>
</br></p>
<details class="info" open="open">
<summary>Reference Implementation</summary>
<p>A "reference implementation" is provided which demonstrates how to implemente code which inspects/interogates an XML Schema Definition (.xsd) and validates an xml file against it.  This is valuable to compare an AS4 message header in XML format against any defined standard.  </p>
</details>
<h2 id="the-xsd-files">The XSD files.</h2>
<p>As examples for a reference implementation, two XML Schema Defiintion files will be used which are publicly available for review and testing purposes. </p>
<p>The first XSD is the <a href="https://docs.oasis-open.org/ebxml-msg/ebms/v3.0/core/os/ebms-header-3_0-200704.xsd">ebMS-3 XML Infoset</a>.  This is a conformance profile dated April of 2007.  </p>
<p>The second XSD is the previously referenced ec.europa.eu <a href="https://ec.europa.eu/digital-building-blocks/code/projects/EDELIVERY/repos/eessi-as4.net/browse/output/doc/schemas/send-pmode-schema.xsd">send-pmode-schema.xsd</a></p>
<p>Both files can be accessed from a local download, or via the Internet directly.  </p>
<h2 id="obtain-the-schema-using-xmlschema">Obtain the schema using xmlschema</h2>
<p>The Python package used is the <a href="https://github.com/sissaschool/xmlschema">xmlschema</a>. Documentation is available at <a href="https://xmlschema.readthedocs.io/en/latest/">xmlschema.readthedocs.io</a>.  Install using <strong>pip</strong>.
<br/>
<br/></p>
<h3 id="example-1-query-the-xsd">Example #1 Query the XSD</h3>
<pre><code>import xmlschema

ebMS3_xsd = xmlschema.XMLSchema('https://docs.oasis-open.org/ebxml-msg/ebms/v3.0/core/os/ebms-header-3_0-200704.xsd')
print (ebMS3_xsd)

ec_xsd = xmlschema.XMLSchema('https://ec.europa.eu/digital-building-blocks/code/projects/EDELIVERY/repos/eessi-as4.net/raw/output/doc/schemas/send-pmode-schema.xsd?at=refs%2Fheads%2FRelease%2Fv4.0.1')
print (ec_xsd)
</code></pre>
<h3 id="output-1">Output #1</h3>
<pre><code>    XMLSchema10(name='ebms-header-3_0-200704.xsd', namespace='http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/')
    XMLSchema10(name='send-pmode-schema.xsd?at=refs%2Fheads%2FRelease%2Fv4.0.1', namespace='eu:edelivery:as4:pmode')
</code></pre>
<p><br/>
<br/></p>
<h3 id="example-2-output-the-xml-elements">Example #2 Output the XML Elements</h3>
<pre><code>import xmlschema

ebMS3_xsd = xmlschema.XMLSchema('https://docs.oasis-open.org/ebxml-msg/ebms/v3.0/core/os/ebms-header-3_0-200704.xsd')
for element in ebMS3_xsd.iter_components():
    print('Element: ', element)


ec_xsd = xmlschema.XMLSchema('https://ec.europa.eu/digital-building-blocks/code/projects/EDELIVERY/repos/eessi-as4.net/raw/output/doc/schemas/send-pmode-schema.xsd?at=refs%2Fheads%2FRelease%2Fv4.0.1')
for element in ec_xsd.iter_components():
    print('Element: ', element)
</code></pre>
<h3 id="output-2">Output #2</h3>
<pre><code>Element:  XMLSchema10(name='ebms-header-3_0-200704.xsd', namespace='http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/')
Element:  XsdAtomicRestriction(name='tns:non-empty-string')
Element:  XsdMinLengthFacet(value=1, fixed=False)
Element:  XsdComplexType(name='tns:Messaging')
Element:  XsdAttributeGroup(['id', '{http://schemas.xmlsoap.org/soap/envelope/}mustUnderstand', '{http://www.w3.org/2003/05/soap-envelope}mustUnderstand', XsdAnyAttribute(namespace=['##other'], process_contents='lax')])
Element:  XsdAttribute(name='id')
[...]


Element:  XMLSchema10(name='send-pmode-schema.xsd?at=refs%2Fheads%2FRelease%2Fv4.0.1', namespace='eu:edelivery:as4:pmode')
Element:  XsdAtomicRestriction(name='tns:MessageExchangePattern')
Element:  XsdEnumerationFacets(['OneWay', 'TwoWay'])
Element:  XsdAtomicRestriction(name='tns:MessageExchangePatternBinding')
Element:  XsdEnumerationFacets(['Push', 'Pull'])
Element:  XsdAtomicRestriction(name='tns:TlsVersion')
[...]
</code></pre>
<p><br/>
<br/></p>
<h3 id="example-3-load-and-validate-xml-against-the-xsd">Example #3 Load and validate XML against the XSD</h3>
<p>xmlschema has two methods to validate a xml message against and xsd.<br />
The first method uses <code>xsd.is_valid(xml)</code>
The second method uses <code>xsd.valdate(xml)</code></p>
<p>The first method is more verbose than then second, which is nearly silent and raises an exception of type  xmlschema.exceptions.XMLSchemaValidationError.</p>
<p>``</p>
<pre><code>ebMS3_xsd = xmlschema.XMLSchema('https://docs.oasis-open.org/ebxml-msg/ebms/v3.0/core/os/ebms-header-3_0-200704.xsd')


ec_xsd = xmlschema.XMLSchema('https://ec.europa.eu/digital-building-blocks/code/projects/EDELIVERY/repos/eessi-as4.net/raw/output/doc/schemas/send-pmode-schema.xsd?at=refs%2Fheads%2FRelease%2Fv4.0.1')

xml_msg = "./sample_msg.xml"
print(xml_msg)

msg_is_valid = ebMS3_xsd.is_valid(xml_msg)
print("\n\nxml message is valid: ", msg_is_valid)
msg_is_valid = ebMS3_xsd.validate(xml_msg)
print("\n\nxml message is valid: ", msg_is_valid)

msg_is_valid = ec_xsd.is_valid(xml_msg)
print("\n\nxml message is valid: ", msg_is_valid)
msg_is_valid = ec_xsd.validate(xml_msg)
print("\n\nxml message is valid: ", msg_is_valid)
</code></pre>
<h3 id="output-3">Output #3</h3>
<pre><code>./sample_msg.xml


xml message is valid:  True


xml message is valid:  None


xml message is valid:  False


1678 """
   1679 Validates an XML data against the XSD schema/component instance.
   1680 
   (...)
   1700 :raises: :exc:`XMLSchemaValidationError` if the XML data instance is invalid.
   1701 """
   1702 for error in self.iter_errors(source, path, schema_path, use_defaults, namespaces,
   1703                               max_depth, extra_validator, allow_empty):
-&gt; 1704     raise error

XMLSchemaValidationError: failed validating &lt;Element '{http://www.w3.org/2003/05/soap-envelope}Envelope' at 0x111a08a40&gt; with XMLSchema10(name='send-pmode-schema.xsd?at=refs%2Fheads%2FRelease%2Fv4.0.1', namespace='eu:edelivery:as4:pmode'):

Reason: &lt;Element '{http://www.w3.org/2003/05/soap-envelope}Envelope' at 0x111a08a40&gt; is not an element of the schema

Instance:

  &lt;S12:Envelope xmlns="urn:un:unece:uncefact:data:standard:CrossIndustryInvoice:2" xmlns:S12="http://www.w3.org/2003/05/soap-envelope" xmlns:eb="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/" xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"&gt;
      &lt;S12:Header&gt;
          &lt;eb:Messaging S12:mustUnderstand="true" id="_9ecb9d3c-cef8-4006-ac18-f425c5c7ae3d"&gt;
              &lt;eb:UserMessage&gt;
                  &lt;eb:MessageInfo&gt;
                      &lt;eb:Timestamp&gt;2011-04-03T14:49:28.886Z&lt;/eb:Timestamp&gt;
                      &lt;eb:MessageId&gt;2011-921@5209999001264.example.com&lt;/eb:MessageId&gt;
                  &lt;/eb:MessageInfo&gt;
                  &lt;eb:PartyInfo&gt;
                      &lt;eb:From&gt;
                          &lt;eb:PartyId type="urn:oasis:names:tc:ebcore:partyid-type:iso6523:0088"&gt;5209999001264&lt;/eb:PartyId&gt;
                          &lt;eb:Role&gt;Seller&lt;/eb:Role&gt;
                      &lt;/eb:From&gt;
                      &lt;eb:To&gt;
                          &lt;eb:PartyId type="urn:oasis:names:tc:ebcore:partyid-type:iso6523:0088"&gt;5209999001295&lt;/eb:PartyId&gt;
                          &lt;eb:Role&gt;Buyer&lt;/eb:Role&gt;
                      &lt;/eb:To&gt;
                  &lt;/eb:PartyInfo&gt;
                  &lt;eb:CollaborationInfo&gt;
                      &lt;eb:Service&gt;http://docs.oasis-open.org/ebxml-msg/as4/200902/service&lt;/eb:Service&gt;
      ...
      ...
  &lt;/S12:Envelope&gt;

Path: /S12:Envelope
</code></pre>
<p><br/>
<br/></p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../smp_rest_query/" class="md-footer__link md-footer__link--prev" aria-label="Previous: SMP REST API Query" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              SMP REST API Query
            </div>
          </div>
        </a>
      
      
        
        <a href="../test_cases/" class="md-footer__link md-footer__link--next" aria-label="Next: Test Cases" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Test Cases
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
    <div class="md-copyright">
        
         
        <!-- <div class="md-copyright__highlight">
        Copyright &copy; 2022 - BPC Exchange Framework Open Source Tools Project
      </div>
      --->
      <div class="md-copyright-display">
        Copyright &copy; 2022 - BPC Exchange Framework Open Source Tools Project</div>
        <div class="md-footer-disclaimer-text">
            <div class="md-footer-disclaimer-statement">
                No Representations or Warranties
            </div>

            THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT
            LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO
            EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN
            AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE
            OR OTHER DEALINGS IN THE SOFTWARE.

        </div>



        
        
        <!--  <div>
            Made with
            <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
                Material for MkDocs
            </a>
            <div>
                
            </div>
        </div>  -->
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.8492ddcf.min.js"></script>
      
        <script src="../js/print-site.js"></script>
      
    
  </body>
</html>